# ─── DevBot .env — Raspberry Pi 5 Template ────────────────────────────────────
# Copy to .env and fill in all values.
# NEVER commit .env to git.
# File permissions: chmod 600 .env && chown devbot:devbot .env

# ── Node.js ────────────────────────────────────────────────────────────────────
NODE_ENV=production
PORT=3100
# 4GB heap — calibrated for 16GB Pi (leaves room for Redis + PG + OS)
NODE_OPTIONS=--max-old-space-size=4096

# ── Services ───────────────────────────────────────────────────────────────────
# Bare-metal (systemd mode)
DATABASE_URL=postgresql://devbot:devbot@127.0.0.1:5432/devbot
REDIS_URL=redis://127.0.0.1:6379
# Docker Compose mode (uncomment and use instead of above)
# DATABASE_URL=postgresql://devbot:devbot@postgres:5432/devbot
# REDIS_URL=redis://redis:6379

# ── AI ─────────────────────────────────────────────────────────────────────────
ANTHROPIC_API_KEY=
OPENAI_API_KEY=

# ── Slack ──────────────────────────────────────────────────────────────────────
SLACK_BOT_TOKEN=xoxb-
SLACK_APP_TOKEN=xapp-
SLACK_SIGNING_SECRET=
SLACK_CHANNEL_ID=

# ── Discord (optional) ─────────────────────────────────────────────────────────
DISCORD_TOKEN=
DISCORD_GUILD_ID=

# ── GitHub ─────────────────────────────────────────────────────────────────────
GITHUB_TOKEN=ghp_
GITHUB_APP_ID=
GITHUB_APP_PRIVATE_KEY=

# ── NATT / Ghost Agent ─────────────────────────────────────────────────────────
# Pi 5 — use system Chromium (apt-installed, arm64 native)
PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1
PLAYWRIGHT_CHROMIUM_EXECUTABLE_PATH=/usr/bin/chromium-browser
CHROMIUM_FLAGS=--no-sandbox --disable-gpu --disable-dev-shm-usage

# NATT vault and cron (NVMe-backed paths)
NATT_VAULT_PATH=/mnt/nvme/natt/vault
NATT_CRON_CONFIG=/mnt/nvme/natt/cron/schedules.json
NATT_REPORT_TEMP_DIR=/mnt/nvme/natt/tmp-reports

# ── Stripe Billing ────────────────────────────────────────────────────────────
# Get keys from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_
# Generate with: stripe listen --forward-to localhost:3101/webhooks/stripe
STRIPE_WEBHOOK_SECRET=whsec_
# Price IDs from: https://dashboard.stripe.com/products
STRIPE_PRICE_PRO_MONTHLY=price_
STRIPE_PRICE_TEAM_MONTHLY=price_
STRIPE_PRICE_ENTERPRISE_MONTHLY=price_

# ── Observability (OTEL + Grafana + Tempo) ─────────────────────────────────────
# Bare-metal (devbot process exports directly to collector)
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
# Docker Compose mode (collector on observability network):
# OTEL_EXPORTER_OTLP_ENDPOINT=http://debo-otel-collector:4318
OTEL_SERVICE_NAME=debo-pi5
GRAFANA_ADMIN_PASSWORD=changeme   # CHANGE before first run

# ── Misc ───────────────────────────────────────────────────────────────────────
TZ=UTC
LOG_LEVEL=info
LOG_DIR=/mnt/nvme/logs/devbot

# ── Autonomous Self-Update Pipeline ───────────────────────────────────────────
# GitHub webhook secret — generate with: openssl rand -hex 32
# Must match the secret configured in GitHub repo Settings → Webhooks
GITHUB_WEBHOOK_SECRET=

# HTTP port for the /webhooks/github and /health endpoints
# Keep separate from PORT (Slack/API) to allow Caddy/nginx routing
WEBHOOK_PORT=3101

# Repo name to watch for push events (must match GitHub repository name)
GITHUB_REPO_NAME=DevBot

# Branches that trigger an update (comma-separated)
GITHUB_WATCHED_BRANCHES=master,main

# Absolute path to update.sh on the Pi (auto-detected if running from /opt/devbot)
UPDATE_SCRIPT_PATH=/opt/devbot/pi5/update.sh

# For Watchtower Docker mode (optional — only for docker-compose deployments)
DOCKER_REGISTRY_USER=tolanilabs
DOCKER_REGISTRY_TOKEN=
